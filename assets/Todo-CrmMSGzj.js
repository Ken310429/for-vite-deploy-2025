import"./axios-CRjjt3tW.js";import{b as e,d as t,e as n,f as r,g as i,h as a,i as o,k as s,l as c,m as l,n as u,o as d,p as f,q as p,r as m,s as h,t as g,u as _,v,w as y,x as b}from"./index-GvmRb5MG.js";import{b as x,c as S,d as C,e as w,f as T,g as E}from"./TodoAPI-BP2PGF_4.js";const D={class:`inputBox`},O={__name:`TodoForm`,emits:[`add-todo-list`],setup(e,{emit:r}){let i=u(`notify`),o=v(``),c=r,l=()=>{if(!o.value.trim()){i(`請輸入待辦事項`);return}c(`add-todo-list`,o.value),o.value=``};return(e,r)=>(f(),s(`div`,D,[_(a(`input`,{type:`text`,"onUpdate:modelValue":r[0]||=e=>o.value=e,placeholder:`請輸入待辦事項`},null,512),[[t,o.value]]),a(`a`,{href:`#`,onClick:n(l,[`prevent`])},r[1]||=[a(`i`,{class:`fa fa-plus`},null,-1)])]))}};var k=O;const A={class:`todoList_label`},j=[`checked`],M={key:0},N={__name:`TodoItem`,props:{todo:{type:Object,required:!0},isEditor:Boolean},emits:[`start-editor`,`put-todo-list`,`change-toggle`,`delete-todo-list`],setup(e,{emit:r}){let i=v(`small`),o=u(`notify`),c=e,d=v(c.todo.content),p=r,g=()=>{d.value=c.todo.content,p(`start-editor`,c.todo.id)},y=e=>{p(`delete-todo-list`,e)},x=e=>{p(`change-toggle`,e)},S=()=>{if(!d.value.trim()){o(`請輸入待辦事項`);return}p(`put-todo-list`,{id:c.todo.id,content:d.value.trim()})};return h(()=>c.todo.content,e=>{d.value=e}),(r,o)=>{let c=m(`Button`);return f(),s(`li`,null,[a(`label`,A,[a(`div`,null,[a(`input`,{class:`todoList_input`,type:`checkbox`,value:`true`,checked:e.todo.status,onClick:o[0]||=t=>x(e.todo.id)},null,8,j),e.isEditor?_((f(),s(`input`,{key:1,type:`text`,"onUpdate:modelValue":o[1]||=e=>d.value=e},null,512)),[[t,d.value]]):(f(),s(`span`,M,b(e.todo.content),1))]),a(`div`,null,[l(c,{icon:`pi pi-pencil`,onClick:g,severity:`secondary`,variant:`text`,rounded:``,size:i.value},null,8,[`size`]),l(c,{icon:`pi pi-check`,onClick:S,severity:`secondary`,variant:`text`,rounded:``,size:i.value},null,8,[`size`]),l(c,{icon:`pi pi-times`,onClick:o[2]||=n(t=>y(e.todo.id),[`prevent`]),severity:`secondary`,variant:`text`,rounded:``,size:i.value},null,8,[`size`])])])])}}};var P=N;const F={class:`todoList_list`},I={class:`todoList_tab`},L={class:`todoList_items`},R={class:`todoList_item`},z={class:`todoList_statistics`},B={__name:`TodoList`,props:{todoList:{type:Array,required:!0},editingId:{type:[Number,String,null],default:null}},emits:[`start-editor`,`put-todo-list`,`change-toggle`,`delete-todo-list`],setup(e,{emit:t}){let c=e,l=t,u=v(`all`),d=e=>{u.value=e,c.editingId!==null&&l(`start-editor`,null)},m=i(()=>{switch(u.value){case`pending`:return c.todoList.filter(e=>!e.status);case`completed`:return c.todoList.filter(e=>e.status);case`all`:default:return c.todoList}}),h=i(()=>c.todoList.filter(e=>!e.status).length);return(t,i)=>(f(),s(`div`,F,[a(`ul`,I,[a(`li`,null,[a(`a`,{href:`#`,class:y({active:u.value===`all`}),onClick:i[0]||=n(e=>d(`all`),[`prevent`])},`全部`,2)]),a(`li`,null,[a(`a`,{href:`#`,class:y({active:u.value===`pending`}),onClick:i[1]||=n(e=>d(`pending`),[`prevent`])},`待完成`,2)]),a(`li`,null,[a(`a`,{href:`#`,class:y({active:u.value===`completed`}),onClick:i[2]||=n(e=>d(`completed`),[`prevent`])},`已完成`,2)])]),a(`div`,L,[a(`ul`,R,[(f(!0),s(r,null,p(m.value,t=>(f(),o(P,{key:t.id,todo:t,isEditor:e.editingId===t.id,onStartEditor:i[3]||=e=>l(`start-editor`,e),onPutTodoList:i[4]||=e=>l(`put-todo-list`,e),onChangeToggle:i[5]||=e=>l(`change-toggle`,e),onDeleteTodoList:i[6]||=e=>l(`delete-todo-list`,e)},null,8,[`todo`,`isEditor`]))),128))]),a(`div`,z,[a(`p`,null,b(h.value)+` 個未完成項目`,1)])])]))}};var V=B;const H={id:`todoListPage`,class:`bg-half`},U={class:`todo_sm`},W={class:`conatiner todoListPage vhContainer`},G={class:`todoList_Content`},K={key:1,class:`todoList_nodata`},q={__name:`Todo`,setup(t){let n=e(),r=u(`notify`),i=v([]),p=v({token:``,nickname:``,uid:``}),h=v(null),_=async()=>{let e=await E(p.value.token);e&&(i.value=e.data)},y=async e=>{let t=await x(e,p.value.token);t&&(r(`${e} 已加入待辦清單`),await _())},D=e=>{h.value=e},O=async e=>{h.value=null;let t=await T(p.value.token,e);t&&await _()},A=async e=>{let t=await S(e,p.value.token);t&&await _()},j=async e=>{h.value===e&&(h.value=null);let t=await w(p.value.token,e);t&&await _()};return d(async()=>{let e=document.cookie.replace(/(?:^|.*;\s*)customTodoToken\s*=\s*([^;]*).*$/i,`$1`),t=await C(e);if(!t.status){r(`請先登入！`),n.push(`/login`);return}p.value=t,p.value.token=e,await _()}),(e,t)=>{let n=m(`RouterLink`);return f(),s(`div`,H,[a(`nav`,null,[a(`h1`,null,[l(n,{to:`/todo`},{default:g(()=>t[0]||=[c(`ONLINE TODO LIST`,-1)]),_:1,__:[0]})]),a(`ul`,null,[a(`li`,U,[l(n,{to:`/todo`},{default:g(()=>[a(`span`,null,b(p.value.nickname)+`的代辦`,1)]),_:1})]),a(`li`,null,[l(n,{to:`/login`},{default:g(()=>t[1]||=[c(`登出`,-1)]),_:1,__:[1]})])])]),a(`div`,W,[a(`div`,G,[l(k,{onAddTodoList:y}),i.value.length?(f(),o(V,{key:0,todoList:i.value,editingId:h.value,onStartEditor:D,onPutTodoList:O,onChangeToggle:A,onDeleteTodoList:j},null,8,[`todoList`,`editingId`])):(f(),s(`p`,K,`目前尚無待辦事項`))])])])}}};var J=q;export{J as default};